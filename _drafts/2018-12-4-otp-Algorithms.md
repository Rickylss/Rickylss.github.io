---
layout: post
title:  "otp算法"
subtitle: ""
date:   2018-12-4 19:56:09 +0800
categories: [DK]
---

# otp算法

> otp(one time password/pin)，一次性密码。是指计算机系统或其他数字设备上只能使用一次的密码，有效期为只有一次登录会话或交易。

## 1、otp简介

传统的账号密码登陆方式，密码是固定的，一般称为静态口令。OTP则是动态的、一次性的。OTP常用于加强认证体系，实现双因子验证；**以传统的账号密码作为第一认证因子，实现OTP算法的Token或者移动设备作为第二认证因子。**双因子验证在许多网站的安全设置中会出现，比如github和vutlr就提供双因子验证。github的双因子验证可参考[github双因子验证](https://rickylss.github.io/)

## 2、otp原理

### 2.1、otp工作流程

1. 使用otp时，用户手中会持有一个token或者移动设备（随机码生成器），在这个随机码生成器中只有一个私钥（uuid）以及一个otp算法，用于计算随机码；
2. 在验证端，同样有一个otp算法和一个私钥库，如果用户输入的密码和私钥库计算所得密码相同，则验证成功，否则验证失败。

### 2.2、算法种子

从上文的介绍中，我们可以知道，otp需要生成一个动态的，变化的随机码，但是2.1中所描述的情景下，生成的随机码是固定的，因此，我们需要加入一个种子来动态改变这个随机码。

用什么做种子非常关键。对这个算法种子的要求有两个：

1. token和验证端，都能够知道这个种子是什么，这样才能算出相同的随机码；
2. 种子是变化的，这样才能使得每次计算的随机码不同。

### 2.3、三种otp

基于2.2中的要求，一共有三种otp算法，分别是：

1. totp，基于时间的otp算法，需要确保客户端和验证端的时间同步，并且该otp密码只存在一小段时间，时间到了就会改变；
2. 基于前次随机码的otp算法，该otp算法基于上次所生成的随机码生成新的随机码，形成一条链，该密码只有每次使用之后才会改变。
3. 基于盘问的otp算法，